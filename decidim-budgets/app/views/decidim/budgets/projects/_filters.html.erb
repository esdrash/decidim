<%#= render partial: "decidim/shared/filter_form_help", locals: { skip_to_id: "projects" } %>

<%= redesigned_filter_form_for filter, url_for, class: "meeting__filter-container", data: { filters: "", component: "accordion" } do |form| %>
  <div class="filter-search filter-container">
    <%= form.search_field :search_text_cont, label: false, class: "input-group-field", placeholder: t(".search"), title: t(".search"), "aria-label": t(".search"), data: { disable_dynamic_change: true } %>
    <button type="submit" aria-controls="meetings" aria_label="<%= t("decidim.meetings.meetings.filters.search") %>">
      <%= icon "search-line"  %>
    </button>
  </div>

  <%# REDESIGN_PENDING: nested filters are mocked %>
  <div class="filter-container">
    <button data-controls="panel-scope" data-open="true">
      <%= icon "arrow-down-s-line" %>
      <%= icon "arrow-up-s-line" %>
      <span><%= "SCOPE MOCK" %></span>
    </button>

    <div id="panel-scope">
      <input type="hidden" name="filter[with_any_date]" value="" autocomplete="off">

      <label for="no-childs">
        <input class="reset-defaults"
          type="checkbox" value="all" name="filter[with_any_date]"
          id="no-childs" hidden="hidden">

        <div class="filter">
          <%= icon "apps-2-line" %>
          <span>No childs</span>
        </div>
      </label>

      <label for="one-nest">
        <input
          class="reset-defaults" type="checkbox" value="upcoming" checked="checked" name="filter[with_any_date]"
          id="one-nest" hidden="hidden">

        <div class="filter">
          <%= icon "calendar-2-line" %>
          <span>One nesting level</span>
          <button data-controls="panel-dropdown-menu-one-nest" onclick="event.preventDefault()">
            <%= icon "arrow-down-s-fill" %>
            <%= icon "arrow-up-s-fill" %>
          </button>
        </div>
      </label>

      <div id="panel-dropdown-menu-one-nest">
        <label for="one-child-1">
          <input
            class="reset-defaults" type="checkbox" value="upcoming" checked="checked" name="filter[with_any_date]"
            id="one-child-1" hidden="hidden">

          <div class="filter">
            <%= icon "calendar-2-line" %>
            <span>Option 1 in child</span>
          </div>
        </label>
        <label for="one-child-2">
          <input
            class="reset-defaults" type="checkbox" value="upcoming" checked="checked" name="filter[with_any_date]"
            id="one-child-2" hidden="hidden">

          <div class="filter">
            <%= icon "calendar-2-line" %>
            <span>Option 2 in child</span>
          </div>
        </label>
      </div>

      <label for="multi-nest">
        <input
          class="reset-defaults" type="checkbox" value="past" name="filter[with_any_date]"
          id="multi-nest" hidden="hidden">

        <div class="filter">
          <%= icon "calendar-check-line" %>
          <span>More nesting levels</span>
          <button data-controls="panel-multi-nest" data-open="false" onclick="event.preventDefault()">
            <%= icon "arrow-down-s-fill" %>
            <%= icon "arrow-up-s-fill" %>
          </button>
        </div>
      </label>

      <div id="panel-multi-nest">
        <label for="multi-nest-1">
          <input
            class="reset-defaults" type="checkbox" value="upcoming" checked="checked" name="filter[with_any_date]"
            id="multi-nest-1" hidden="hidden">

          <div class="filter">
            <%= icon "calendar-2-line" %>
            <span>sublevel 1 element 1</span>
            <button data-controls="panel-multi-nest-1" data-open="false" onclick="event.preventDefault()">
              <%= icon "arrow-down-s-fill" %>
              <%= icon "arrow-up-s-fill" %>
            </button>
          </div>
        </label>

        <div id="panel-multi-nest-1">
          <label for="multi-nest-1-1">
            <input
              class="reset-defaults" type="checkbox" value="past" name="filter[with_any_date]"
              id="multi-nest-1-1" hidden="hidden">

            <div class="filter">
              <%= icon "calendar-check-line" %>
              <span>sublevel 2 element 1</span>
            </div>
          </label>
          <label for="multi-nest-1-2">
            <input
              class="reset-defaults" type="checkbox" value="past" name="filter[with_any_date]"
              id="multi-nest-1-2" hidden="hidden">

            <div class="filter">
              <%= icon "calendar-check-line" %>
              <span>sublevel 2 element 2</span>
            </div>
          </label>
        </div>

        <label for="one-child-2">
          <input
            class="reset-defaults" type="checkbox" value="upcoming" checked="checked" name="filter[with_any_date]"
            id="one-child-2" hidden="hidden">

          <div class="filter">
            <%= icon "calendar-2-line" %>
            <span>sublevel 1 element 2</span>
            <button data-controls="panel-multi-nest-2" data-open="false" onclick="event.preventDefault()">
              <%= icon "arrow-down-s-fill" %>
              <%= icon "arrow-up-s-fill" %>
            </button>
          </div>
        </label>

        <div id="panel-multi-nest-2">
          <label for="multi-nest-2-1">
            <input
              class="reset-defaults" type="checkbox" value="past" name="filter[with_any_date]"
              id="multi-nest-2-1" hidden="hidden">

            <div class="filter">
              <%= icon "calendar-check-line" %>
              <span>sublevel 2 element 1</span>
            </div>
          </label>
          <label for="multi-nest-2-2">
            <input
              class="reset-defaults" type="checkbox" value="past" name="filter[with_any_date]"
              id="multi-nest-2-2" hidden="hidden">

            <div class="filter">
              <%= icon "calendar-check-line" %>
              <span>sublevel 2 element 2</span>
            </div>
          </label>
        </div>
      </div>
    </div>
  </div>

<% end #end_form %>


<%##= render partial: "decidim/shared/filter_form_help", locals: { skip_to_id: "projects" } %>

<%#= filter_form_for filter do |form| %>
  <!-- <div class="filters__section">
    <div class="filters__search">
      <div class="input-group">
        <%#= form.search_field :search_text_cont, label: false, class: "input-group-field", placeholder: t(".search"), title: t(".search"), "aria-label": t(".search"), data: { disable_dynamic_change: true } %>
        <div class="input-group-button">
          <button type="submit" class="button" aria-controls="projects">
            <%#= icon "magnifying-glass", aria_label: t(".search"), role: "img" %>
          </button>
        </div>
      </div>
    </div>
  </div> -->

  <%# if voting_finished? %>
    <%#= form.check_boxes_tree :with_any_status, filter_status_values, legend_title: t(".status"), "aria-controls": "projects" %>
  <%# end %>

  <%# if current_component.has_subscopes? %>
    <%#= form.check_boxes_tree :with_any_scope, resource_filter_scope_values(budget.scope), legend_title: t(".scope"), "aria-controls": "projects" %>
  <%# end %>

  <%# if current_participatory_space.categories.any? %>
    <%#= form.check_boxes_tree :with_any_category, filter_categories_values, legend_title: t(".category"), "aria-controls": "projects" %>
  <%# end %>

  <%#= hidden_field_tag :order, order, id: nil, class: "order_filter" %>
<%# end %>
